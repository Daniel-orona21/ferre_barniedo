<div class="main-container">
  <!-- <div class="side-menu">
    <h4>Tipo de intenvario</h4>
    <ul>
      <li class="active">
        <span class="material-symbols-outlined">qr_code_scanner</span>
        Inventario aleatorio
      </li>
      <li>
        <span class="material-symbols-outlined">calendar_today</span>
        Inventario Anual
      </li>
    </ul>
  </div> -->

  <div class="content">
    <div class="card">
      <div class="card-header">
        <div class="encabezado">
          <div class="selector">
            <div class="selection-indicator" #indicator></div>
            <div 
              class="opcion" 
              [class.selected]="activeView === 'aleatorio'" 
              (click)="setActiveView('aleatorio', aleatorioOption)"
              #aleatorioOption>
              Inventario aleatorio
            </div>
            <div 
              class="opcion" 
              [class.selected]="activeView === 'anual'" 
              (click)="setActiveView('anual', anualOption)"
              #anualOption>
              Inventario anual
            </div>
          </div>
          <div class="filtros">
              <div class="categoria">
                  <h3>Almacen</h3>
                  <span class="material-symbols-outlined btn-icon">keyboard_arrow_down</span>
              </div>
              <div class="date-picker-wrapper">
                <label>Desde</label>
                <input type="text" readonly value="20/06/2025">
                <span class="material-symbols-outlined">calendar_today</span>
              </div>
              <div class="date-picker-wrapper">
                <label>Hasta</label>
                <input type="text" readonly value="24/06/2025">
                <span class="material-symbols-outlined">calendar_today</span>
              </div>
              <div class="botonera">
                <button class="btn-primary" (click)="openNewInventarioModal()">
                  <span class="material-symbols-outlined">add</span>
                  Nuevo
                </button>
              </div>
          </div>
        </div>
      </div>
      <div class="card-body">
        <table class="table">
          <thead>
            <tr>
              <th>Fecha</th>
              <th>Almacen</th>
              <th>Almacen en proceso</th>
              <th>Anaquel</th>
              <th>Cantidad registrada</th>
              <th>Cantidad reportada</th>
              <th>Usuario</th>
              <th>Usuario validador</th>
              <th>Estatus</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of activeInventarios">
              <td>{{ item.fecha }}</td>
              <td>{{ item.almacen }}</td>
              <td>{{ item.almacenProceso }}</td>
              <td>{{ item.anaquel }}</td>
              <td>{{ item.cantidadRegistrada }}</td>
              <td>{{ item.cantidadReportada }}</td>
              <td>{{ item.usuario }}</td>
              <td>{{ item.usuarioValidador }}</td>
              <td>
                <span class="status" [ngClass]="{
                  'correcto': item.estatus === 'Correcto',
                  'discrepancias': item.estatus === 'Discrepancias',
                  'pendientes': item.estatus === 'Pendientes'
                }">
                  {{ item.estatus }}
                </span>
              </td>
              <td>
                <div class="acciones">
                  <button class="btn-icon" (click)="openModal(item, 'view')">
                    <span class="material-symbols-outlined icon-view">visibility</span>
                  </button>
                  <button class="btn-icon" (click)="openModal(item, 'edit')">
                    <span class="material-symbols-outlined icon-edit">edit</span>
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="card-footer">
        <div class="pagination-controls">
          <span>Resultados por pagina:</span>
          <select class="form-select">
            <option selected>10</option>
            <option>20</option>
            <option>50</option>
          </select>
        </div>
        <div class="pagination-info">
          <span>1-10 de 30</span>
          <div class="btn-group">
            <button class="btn-light">
              <span class="material-symbols-outlined">chevron_left</span>
            </button>
            <button class="btn-light">
              <span class="material-symbols-outlined">chevron_right</span>
            </button>
          </div>
        </div>
      </div>
    </div> 
  </div>
</div>

<div class="modal-overlay" *ngIf="isModalVisible">
  <div class="modal-content">
    <div class="modal-header">
      <h2 *ngIf="modalAction === 'view'">Ver Inventario</h2>
      <h2 *ngIf="modalAction === 'edit'">Editar Inventario</h2>
      <h2 *ngIf="modalAction === 'new'">Nuevo Inventario</h2>
      <button class="btn-icon" (click)="closeModal()">
        <span class="material-symbols-outlined">close</span>
      </button>
    </div>
    <div class="modal-body" *ngIf="selectedInventario">
      <div *ngIf="modalAction === 'view'">
        <div class="view-grid">
          <p><strong>Fecha:</strong> {{ selectedInventario.fecha }}</p>
          <p><strong>Almacen:</strong> {{ selectedInventario.almacen }}</p>
          <p><strong>Almacen en proceso:</strong> {{ selectedInventario.almacenProceso }}</p>
          <p><strong>Anaquel:</strong> {{ selectedInventario.anaquel }}</p>
          <p><strong>Cantidad registrada:</strong> {{ selectedInventario.cantidadRegistrada }}</p>
          <p><strong>Cantidad reportada:</strong> {{ selectedInventario.cantidadReportada }}</p>
          <p><strong>Usuario:</strong> {{ selectedInventario.usuario }}</p>
          <p><strong>Usuario validador:</strong> {{ selectedInventario.usuarioValidador }}</p>
          <p><strong>Estatus:</strong> {{ selectedInventario.estatus }}</p>
        </div>
      </div>
      <div *ngIf="modalAction === 'edit' || modalAction === 'new'">
        <div class="form-grid">
          <div class="form-group">
            <label for="fecha">Fecha</label>
            <input type="date" id="fecha" class="form-control" [(ngModel)]="selectedInventario.fecha">
          </div>
          <div class="form-group">
            <label for="almacen">Almacen</label>
            <input type="text" id="almacen" class="form-control" [(ngModel)]="selectedInventario.almacen">
          </div>
          <div class="form-group">
            <label for="almacenProceso">Almacen en proceso</label>
            <input type="text" id="almacenProceso" class="form-control" [(ngModel)]="selectedInventario.almacenProceso">
          </div>
          <div class="form-group">
            <label for="anaquel">Anaquel</label>
            <input type="text" id="anaquel" class="form-control" [(ngModel)]="selectedInventario.anaquel" [disabled]="modalAction === 'edit'">
          </div>
          <div class="form-group">
            <label for="cantidadRegistrada">Cantidad registrada</label>
            <input type="number" id="cantidadRegistrada" class="form-control" [(ngModel)]="selectedInventario.cantidadRegistrada">
          </div>
          <div class="form-group">
            <label for="cantidadReportada">Cantidad reportada</label>
            <input type="number" id="cantidadReportada" class="form-control" [(ngModel)]="selectedInventario.cantidadReportada">
          </div>
          <div class="form-group">
            <label for="usuario">Usuario</label>
            <input type="text" id="usuario" class="form-control" [(ngModel)]="selectedInventario.usuario">
          </div>
          <div class="form-group">
            <label for="usuarioValidador">Usuario validador</label>
            <input type="text" id="usuarioValidador" class="form-control" [(ngModel)]="selectedInventario.usuarioValidador">
          </div>
          <div class="form-group">
            <label for="estatus">Estatus</label>
            <select id="estatus" class="form-control" [(ngModel)]="selectedInventario.estatus">
              <option>Pendientes</option>
              <option>Correcto</option>
              <option>Discrepancias</option>
            </select>
          </div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn-secondary" (click)="closeModal()">Cancelar</button>
      <button class="btn-primary" *ngIf="modalAction === 'edit' || modalAction === 'new'" (click)="saveInventario()">Guardar Cambios</button>
    </div>
  </div>
</div>
